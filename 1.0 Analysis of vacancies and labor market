-- Получение статистики по заработной плате
SELECT	MIN(salary_from) AS min_salary_from_RUB,
		MAX(salary_from) AS max_salary_from_RUB,
		ROUND(AVG (salary_from),2) AS AVG_salary_from_RUB,
		MIN(salary_to) AS min_salary_to_RUB,
		MAX(salary_to) AS max_salary_to_RUB,
		ROUND(AVG (salary_to),2) AS AVG_salary_to_RUB,
		ROUND(AVG (salary_from)/88.6,2) AS AVG_salary_from_USD,--USD/RUB 88.6
		ROUND(AVG (salary_to)/88.6,2) AS AVG_salary_to_USD--USD/RUB 88.6	
FROM public.parcing_table
WHERE salary_from>1000 AND salary_from>0 AND salary_to>0

-- Минимальная предлагаемая зарплата начинается с 50 рублей, что, скорее всего, является ошибкой данных -->исключена фильтром
-- Средняя зарплата в категории «от» составляет около 1251 USD, 
--а в категории «до» — около 1742 USD. Это указывает на то, что работодатели готовы платить
--аналитикам данных и системным аналитикам в среднем около 1500 USD. 





-- Количество вакансий по регионам
SELECT area,
		count (id) AS quantity --number of vacancies
FROM public.parcing_table
GROUP BY area
ORDER BY count (id) DESC;

-- Москва и Санкт-Петербург — лидеры по количеству вакансий. 
-- Это неудивительно, учитывая, что это крупнейшие города 
-- с развитой инфраструктурой и большим количеством компаний. 
-- В Екатеринбурге, Нижнем Новгороде и Новосибирске также значительное 
-- количество вакансий — это указывает на развитый рынок труда для аналитиков данных в этих регионах.





-- Количество вакансий по компаниям
SELECT employer ,
	count (id) AS quantity --number of vacancies
FROM public.parcing_table
GROUP BY employer
HAVING count (id)>20
ORDER BY quantity DESC;

-- СБЕР предлагает 243 вакансии и является крупнейшим работодателем для аналитиков данных и 
-- системных аналитиков. Это может говорить о значительных инвестициях в аналитику и технологические решения
-- в компании. К тому же в банковской среде всегда нужны аналитики. WILDBERRIES, Ozon 
-- и другие крупные компании также активно ищут специалистов в области данных, 
-- что говорит о высоком спросе на аналитиков в крупных корпорациях. Вдруг и вы захотите не только
-- покупать на маркетплейсах, но и проанализировать, что другие покупают.





-- Количество вакансий по типу занятости
SELECT	employment,
		COUNT(*) AS num_vacancies
FROM public.parcing_table
GROUP BY employment
ORDER BY  num_vacancies DESC;

-- Подавляющее большинство вакансий (1764) предлагают полную занятость.
-- Это указывает на то, что работодатели предпочитают нанимать 
-- аналитиков данных и системных аналитиков на постоянные позиции.
-- Возможно, дело в необходимости глубоко погружаться в проекты и
-- долго в них участвовать.





-- Количество вакансий по графику работы
SELECT	schedule ,
		COUNT(*) AS num_vacancies
FROM public.parcing_table
GROUP BY schedule
ORDER BY  num_vacancies DESC;

-- Большинство вакансий (1441) предлагают работу с полным днём. 
-- Однако значительное количество вакансий (310) также позволяет 
-- удалённую работу. Это указывает на то, что работодатели готовы быть
-- гибкими в современных условиях. Возможно, в ответ на пандемию COVID-19 
-- и изменения в предпочтениях работников.




-- Выявление грейда требуемых специалистов по опыту
SELECT experience,
       COUNT(*) AS num_vacancies
FROM public.parcing_table 
GROUP BY experience 
ORDER BY num_vacancies DESC;

-- Наибольшее количество вакансий предназначено для специалистов с опытом от 1 до 3 лет (Junior+), 
-- что свидетельствует о высоком спросе на специалистов начального и среднего уровней. 
-- Вакансий для Middle-специалистов (3–6 лет) также много, в то время как спрос 
-- на Senior-специалистов (6+ лет) крайне низкий, возможно, из-за узкого круга
-- специалистов с таким уровнем опыта или предпочитаемых долгосрочных позиций.
-- Однако важно понимать, что Senior-аналитиков могут чаще искать по другим каналам.





-- Частота упоминания hard и soft skills (пример для key_skills_1) (Аналогично для остальных столбцов key_skills и soft_skills)
SELECT key_skills_1,
       COUNT(*) AS num_mention
FROM public.parcing_table 
GROUP BY key_skills_1 
ORDER BY num_mention DESC;
- Среди ключевых навыков чаще упоминается «Анализ данных» (312 упоминаний), 
-- что логично для позиций аналитиков данных. SQL (161 упоминание) и MS SQL (87 упоминаний) также являются
-- важными навыками, что подчёркивает важность работы с базами данных. «Документация» (89 упоминаний) 
-- указывает на необходимость ведения точных записей и отчётов. Это особенно актуально для системных аналитиков.
-- Примечательно, что в топ ключевых навыков не входит Python, однако его часто подразумевают под навыком «Анализ данн





-- Определение доли грейдов среди вакансий аналитиков
SELECT experience,
       COUNT(*) AS num_vacancies,
       ROUND(COUNT(*) * 100.0 /
               (SELECT COUNT(*)
                FROM public.parcing_table
                WHERE name LIKE '%Аналитик данных%'
                  OR name LIKE '%Системный аналитик%'), 2) AS percent_vacancies
FROM public.parcing_table 
WHERE name LIKE '%Аналитик данных%' OR name LIKE '%Системный аналитик%'
GROUP BY experience 
ORDER BY percent_vacancies DESC;


-- Большинство вакансий для аналитиков данных и системных аналитиков предназначены
-- для специалистов уровня Junior+ (64.91%) и Middle (25.58%). Это подтверждает высокую 
-- потребность в специалистах начального и среднего уровней. 
-- Доли вакансий для стажёров (9.08%) и Senior (0.43%) значительно ниже, 
-- что может указывать на меньшую потребность в новичках и высококвалифицированных специалистах, 
-- но это совсем не так — тут уже надо понимать особенности рынка.   
